
# 协商缓存

利用 【last-modified，if-modified-since】和【etag，if-none-match】这2对请求响应头来管理

last-modified标识本地文件最后修改日期，浏览器会在请求头中加上if-modified-since（上次返回来的last-modified），询问服务器该日期后资源是否有更新，有就将新资源发送回来

Etag标识文件是否发生变化，只要资源发生了变化，etag都会改变，etag可以保证每一个资源是唯一的，if-none-match会把上次返回来的etag发送给服务器，询问该资源的etag是否发生了变化，有变化就发送新的资源回来

etag优先级比last-modified高

# 强缓存

强缓存不需要发送请求到服务器，根据请求头expires和cache-control判断是否命中强缓存

# 强缓存和协商缓存流程

- 浏览器请求，判断是否有缓存，没缓存就直接请求

- 有缓存没有过期，从缓存读取

- 有缓存但是已经过期了，判断是否有etag，有就向web服务器发送if-none-match请求，有服务端决策是使用缓存的还是使用新的资源，没有etag的情况下，查看是否有last-modified，有就向服务器发送if-modified-since请求。如果都没有，直接向浏览器发送请求获取资源即可


# 地址栏输入 URL 敲下回车后发生的事情

- url解析，判断是否为合法的url

- dns查询，查询域名对应的ip地址

- 建立tcp链接

- 发送http请求，浏览器发送http请求到目标服务器

- 服务器接收到浏览器的请求之后，会响应请求，并把请求数据返回给浏览器

- 浏览器接收到服务器的资源后，对资源进行解析和渲染

# tcp三次握手

第一次握手是客户端发包给服务端，服务端收到，这样服务器就可以得知客户端的发送能力和服务端的接受能力是正常的

第二次握手是服务器发包给客户端，客户端收到，这样子客户端就能得出结论，服务端的接受、发送能力，客户端的接受、发送能力是正常的。不过此时服务器还不能确认客户端的接受能力是否正常

第三次握手是客户端发包给服务端，服务端收到，这样子服务端就可以的出结论，客户端的接受、发送能力正常，服务器自己的发送、接收能力也正常

# 四次挥手

tcp终止一个连接，需要经过四次挥手

第一次挥手，客户端发送一个报文，此时客户端处于停止发送数据，等待服务器确认的状态

第二次挥手，服务器收到报文之后，会发送报文给客户端，表明已经收到了客户端的报文，此时服务端处于关闭等待状态

第三次挥手，如果服务端也想断开连接，和客户端第一次挥手一样，发送一个报文给客户端，此时服务端处理等待状态

第四次挥手，客户端收到服务端的报文后，同样发送一个报文作为应答，服务端收到报文后，就会关闭连接