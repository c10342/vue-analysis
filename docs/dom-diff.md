# 虚拟DOM

通过一个js对象来描述DOM节点。虚拟DOM包含真实DOM节点所需要的一系列属性，比如`tag`表示节点标签，`text`表示节点中包含文本，`children`表示该节点包含的子节点等等。

**VNode类型**

- 注释节点
- 文本节点
- 元素节点
- 组件节点
- 函数式组件节点
- 克隆节点

# patch 过程

核心：以新的VNode为基准，改造旧的VNode，使之成为跟新的VNode一样，这就是patch过程要干的事情

三件事：

- 创建节点：新的VNode有而旧的VNode没有，就在旧的VNode中创建

- 删除节点：新的VNode没有而旧的VNode有，就从旧的VNode中删除

- 更新节点：新的VNode和旧的VNode都有，以新VNode为基准，更新旧的VNode

# 创建节点

- 根据`tag`判断是否为元素节点，是就创建元素节点，不是就走下一步

- 根据`isComment`判断是否为注释节点，是就创建注释节点，不是就走下一步

- 既不是注释节点，也不是元素节点，那就认为是文本节点。创建文本节点

# 更新节点（patchVNode）

1、新旧节点完全是一样的（`===`比较），就退出程序

2、新旧节点都是静态节点，退出程序

3、如果新VNode是文本节点，并且跟旧的VNode的文本内容不一样，那么无论旧的VNode节点是什么，用新VNode的文本替换真实DOM的内容

4、如果新VNode有子节点
    1、如果新旧VNode都有子节点，调用`updateChildren`函数更新知子节点
    2、只有新Vnode有子节点，旧VNode没有子节点
        1、如果旧的VNode有文本节点，清空文本节点，再把新Vnode的子节点添加到真实DOM中
        2、如果旧的VNode没有文本节点，吧新Vnode的子节点添加到真实DOM中

5、只有旧节点有子节点，并且新VNode也没有子节点的情况，清空DOM中的子节点

6、新旧VNode都没有子节点，但是旧Vnode有文本节点，清空DOM中的文本节点


# 更新孩子节点（updateChildren）

1、准备4个指针，分别指向新孩子节点的第一个位置和最后一个位置，旧孩子节点的第一个位置和最后一个位置

2、以新前，新后，旧前，旧后的方式开始对比节点

3、如果旧前指向的节点不存在，旧前指针自增，对比下一个

4、如果旧后指向的节点不存在，旧后指针自减，对比下一个

5、新前和旧前对比，如果相同，就把2个节点进行`patchVNode`更新，新前，旧前和新前指针自增，对比下一个

6、新后与旧后对比，如果相同，就把2个节点进行`patchVNode`更新，新后，旧后和新前指针自减，对比下一个

7、新后与旧前对比，如果相同，先把2个节点进行`patchVNode`更新，然后把旧前指针指向的节点移动到所有未处理的旧孩子节点的后面，旧前指针自增，新后指针自减

8、新前与旧后对比，如果相同，先把2个节点进行`patchVNode`更新，然后把旧后指针指向的节点移动到所有未处理的旧孩子节点的前面，新前指针自增，旧后指针自减

10、如果都不属于之前的几种情况，就进行常规的循环对比
    1、如果
